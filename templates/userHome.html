<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/index.css') }}">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/form.css') }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static',filename='favicon_io/apple-touch-icon.png')}}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static',filename='favicon_io/favicon-32x32.png')}}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static',filename='favicon_io/favicon-16x16.png')}}">
  <link rel="manifest" href="{{ url_for('static',filename='favicon_io/site.webmanifest')}}">
  <title>User Home</title>
</head>
<header>
  <h1>Welcome {{username}}</h1>
  <nav class="navlinks">
    <a href="/createEvent/{{ user_id }}">Create a New Event</a>
    <a href='/'>Sign Out</a>
  </nav>
</header>
<body>
  <h2 class="event_title">Your events:</h2>
  {% if num_events == 0 %}
    <p class="no_event"><b>Looks like you have no events scheduled yet</b>
    <br><br> Press the "Create a New Event" button above to make your first event</p>
  {% endif %}
  {% for event in events %}
  <div class="event-div" id='{{event["_id"]}}'>
    <div class="Info-Div">
      <div class="Data-Div">
        <h3> For: {{ event["eventName"] }} </h3>
        <p> From {{ event["startTime"] }} to {{ event["endTime"] }} on {{ event["eventDate"] }} </p>
        <p> {{ event["eventLocation"] }} </p>
        <p> {{ event["eventDescription"] }} </p>
        <!-- NOT YET IMPLEMENTED -->
        <p style="display: none;"> RSVP at: <a href='{{url}}rsvp/{{event["_id"]}}''>{{url}}rsvp/{{event["_id"]}}</a></p>
      </div>
      <div class="Delete-Div">
        <form action='{{ url_for("delete_event", event_id=event["_id"], user_id=user_id) }}' method="POST" class="drop-button-class">
          <button type="submit" onclick="return confirm('Are you sure you want to delete this event?');" class="drop-button">
            Delete Event
          </button>
        </form>
        <form action='{{ url_for("update_event", event_id=event["_id"], user_id=user_id) }}' method="GET" class="drop-button-class">
          <button type="submit" onclick="" class="drop-button">
            Update Event
          </button>
        </form>
        {% if event["rsvps"]|length != 0 %}
        <!-- NOT YET IMPLEMENTED -->
        <form action='' method="POST" class="drop-button-class" style="display: none">
          <button type="submit" onclick="" class="drop-button">
            Contact Responders
          </button>
        </form>
        {% endif %}
      </div>
    </div>
    <div class="rsvp-table-div">
      {% if event["rsvps"]|length != 0 %}
      <table>
        <thead>
        <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Email</th>
        </tr>
        </thead>
        <tbody>
        {% for person in event["rsvps"] %}
        <tr>
          <td>{{ person["firstName"] }} </td>
          <td>{{ person["lastName"] }} </td>
          <td>{{ person["email"] }} </td>
        </tr>
        {% endfor %}
        </tbody>
      </table>
      {% else %}
      <b>No one has RSVP'd for this event yet <br> Share the link above to recieve RSVP's</b>
      {% endif %}
    </div>
  </div>
  {% endfor %}
  <form action='{{ url_for("delete_account", user_id=user_id) }}' method="POST" id="delete-account">
    <button type="submit" onclick="return confirm('Are you sure you want to delete your account? ALL your events will also be deleted');">Delete Account</button>
  </form>
  <script src="{{ url_for('static',filename='scripts/debug.js') }}"></script>
  <script src="{{ url_for('static',filename='scripts/userHome.js') }}"></script>
</body>
<footer>
  Website by Thomas Sharp
</footer>
</html>